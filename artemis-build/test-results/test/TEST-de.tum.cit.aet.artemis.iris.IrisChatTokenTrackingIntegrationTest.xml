<?xml version="1.0" encoding="UTF-8"?>
<testsuite name="de.tum.cit.aet.artemis.iris.IrisChatTokenTrackingIntegrationTest" tests="3" skipped="0" failures="0" errors="0" timestamp="2025-02-14T23:43:46" hostname="fv-az1721-502" time="1.138">
  <properties/>
  <testcase name="testTokenTrackingHandledExerciseChat()" classname="de.tum.cit.aet.artemis.iris.IrisChatTokenTrackingIntegrationTest" time="0.457"/>
  <testcase name="testTokenTrackingSavedExerciseChat()" classname="de.tum.cit.aet.artemis.iris.IrisChatTokenTrackingIntegrationTest" time="0.274"/>
  <testcase name="testTokenTrackingExerciseChatWithPipelineFail()" classname="de.tum.cit.aet.artemis.iris.IrisChatTokenTrackingIntegrationTest" time="0.404"/>
  <system-out><![CDATA[
Starting logs for IrisChatTokenTrackingIntegrationTest

  Starting logs for IrisChatTokenTrackingIntegrationTest > testTokenTrackingHandledExerciseChat()
    23:43:46.214 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : Generate 2 students...
    23:43:46.216 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : 2 students generated. Generate 0 tutors...
    23:43:46.218 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : 0 tutors generated. Generate 0 editors...
    23:43:46.219 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : 0 editors generated. Generate 0 instructors...
    23:43:46.220 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : 0 instructors generated
    23:43:46.222 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : Removing 3 users from all courses...
    23:43:46.223 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : Removing 3 users from all courses. Done
    23:43:46.223 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : Save 2 users to database...
    23:43:46.224 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : Save 2 users to database. Done
    23:43:46.278 | 398 ool-1-worker-162 | DEBUG | PersonalAccessTokenManagementService : Generate secure vcs access token
    23:43:46.456 | 398 ool-1-worker-162 | INFO  | i.z.t.d.l.EmbeddedDatabaseReporter   : JDBC URL to connect to 'dataSource': url='jdbc:h2:tcp://localhost:41063/mem:f240edcd-27ce-47a3-b4ab-a6a00c154135;USER=sa', scope='IrisChatTokenTrackingIntegrationTest#testTokenTrackingHandledExerciseChat'
    23:43:46.462 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.s.f.ApiVersionFilter     : Adding Version to Request POST /api/iris/sessions/17/messages
    23:43:46.495 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.i.s.w.IrisWebsocketService : Sent message to Iris user irischattokentrackingintegrationstudent1 on topic /topic/iris/17: IrisChatWebsocketDTO[type=MESSAGE, message=IrisMessage{id=24, session=IrisExerciseChatSession{user=irischattokentrackingintegrationstudent1,exercise=ProgrammingExercise{id=434, templateRepositoryUri='null', solutionRepositoryUri='null', templateBuildPlanId='null', solutionBuildPlanId='null', allowOnlineEditor='true', allowOnlineIde='false', programmingLanguage='JAVA', packageName='de.test'', testCasesChanged='false'}}, sentAt=2025-02-14T23:43:46.484438Z, helpful=null, sender=USER, content=[IrisMessageContent{message=24, textContent='The happy dog jumped over the lazy dog.'}, IrisMessageContent{message=24, textContent='The happy dog jumped over the lazy dog.'}, IrisMessageContent{message=24, textContent='The happy dog jumped over the lazy dog.'}], messageDifferentiator=null}, rateLimitInfo=IrisRateLimitInformation[currentMessageCount=0, rateLimit=-1, rateLimitTimeframeHours=0], stages=null, suggestions=null, tokens=null]
    23:43:46.513 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.i.s.w.IrisWebsocketService : Sent message to Iris user irischattokentrackingintegrationstudent1 on topic /topic/iris/17: IrisChatWebsocketDTO[type=STATUS, message=null, rateLimitInfo=IrisRateLimitInformation[currentMessageCount=0, rateLimit=-1, rateLimitTimeframeHours=0], stages=[PyrisStageDTO[name=Preparing, weight=10, state=IN_PROGRESS, message=null], PyrisStageDTO[name=Executing pipeline, weight=30, state=NOT_STARTED, message=null]], suggestions=null, tokens=null]
    23:43:46.515 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.p.s.AbstractGitService     : getLastCommitHash http://localhost:49152/git/SHORTE5E833960D9B3040CE093EE0E7917FB42E7CTSTEXC/shorte5e833960d9b3040ce093ee0e7917fb42e7ctstexc-exercise.git
    23:43:46.515 | 398 ool-1-worker-162 | ERROR | d.t.c.a.a.p.s.AbstractGitService     : Cannot use ssh properly because of mismatch of Jgit transport object: org.eclipse.jgit.transport.TransportLocal@aa0f2a3
    23:43:46.521 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.p.s.AbstractGitService     : getLastCommitHash http://localhost:49152/git/SHORTE5E833960D9B3040CE093EE0E7917FB42E7CTSTEXC/shorte5e833960d9b3040ce093ee0e7917fb42e7ctstexc-solution.git
    23:43:46.522 | 398 ool-1-worker-162 | ERROR | d.t.c.a.a.p.s.AbstractGitService     : Cannot use ssh properly because of mismatch of Jgit transport object: org.eclipse.jgit.transport.TransportLocal@4a5a6507
    23:43:46.525 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.p.service.GitService       : Cloning from file:///tmp/SHORTE5E833960D9B3040CE093EE0E7917FB42E7CTSTEXC/shorte5e833960d9b3040ce093ee0e7917fb42e7ctstexc-tests.git/ to repos/server-integration-test/SHORTE5E833960D9B3040CE093EE0E7917FB42E7CTSTEXC/shorte5e833960d9b3040ce093ee0e7917fb42e7ctstexc-tests
    23:43:46.531 | 398 ool-1-worker-162 | ERROR | d.t.c.a.a.p.s.AbstractGitService     : Cannot use ssh properly because of mismatch of Jgit transport object: org.eclipse.jgit.transport.TransportLocal@1feacbed
    23:43:46.589 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.i.s.w.IrisWebsocketService : Sent message to Iris user irischattokentrackingintegrationstudent1 on topic /topic/iris/17: IrisChatWebsocketDTO[type=STATUS, message=null, rateLimitInfo=IrisRateLimitInformation[currentMessageCount=0, rateLimit=-1, rateLimitTimeframeHours=0], stages=[PyrisStageDTO[name=Preparing, weight=10, state=DONE, message=null], PyrisStageDTO[name=Executing pipeline, weight=30, state=IN_PROGRESS, message=null]], suggestions=null, tokens=null]
    23:43:46.601 | 398 ool-1-worker-162 | INFO  | d.t.c.a.a.c.s.jwt.TokenProvider      : Invalid JWT token: artemislocal_ase_in_tum_de-unknown-1739576626507-rIvLIkgyAN from source bearer
    23:43:46.601 | 398 ool-1-worker-162 | INFO  | d.t.c.a.a.c.s.jwt.TokenProvider      : Invalid JWT token: artemislocal_ase_in_tum_de-unknown-1739576626507-rIvLIkgyAN from source bearer
    23:43:46.601 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.s.f.ApiVersionFilter     : Adding Version to Request POST /api/public/pyris/pipelines/tutor-chat/runs/artemislocal_ase_in_tum_de-unknown-1739576626507-rIvLIkgyAN/status
    23:43:46.622 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.i.s.w.IrisWebsocketService : Sent message to Iris user irischattokentrackingintegrationstudent1 on topic /topic/iris/17: IrisChatWebsocketDTO[type=MESSAGE, message=IrisMessage{id=25, session=IrisExerciseChatSession{user=irischattokentrackingintegrationstudent1,exercise=ProgrammingExercise{id=434, templateRepositoryUri='null', solutionRepositoryUri='null', templateBuildPlanId='null', solutionBuildPlanId='null', allowOnlineEditor='true', allowOnlineIde='false', programmingLanguage='JAVA', packageName='de.test'', testCasesChanged='false'}}, sentAt=2025-02-14T23:43:46.613460Z, helpful=null, sender=LLM, content=[IrisMessageContent{message=25, textContent='Hello World'}], messageDifferentiator=null}, rateLimitInfo=IrisRateLimitInformation[currentMessageCount=0, rateLimit=-1, rateLimitTimeframeHours=0], stages=[PyrisStageDTO[name=DoneTest, weight=10, state=DONE, message=Done]], suggestions=null, tokens=null]

  Starting logs for IrisChatTokenTrackingIntegrationTest > testTokenTrackingSavedExerciseChat()
    23:43:46.680 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : Generate 2 students...
    23:43:46.686 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : 2 students generated. Generate 0 tutors...
    23:43:46.690 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : 0 tutors generated. Generate 0 editors...
    23:43:46.695 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : 0 editors generated. Generate 0 instructors...
    23:43:46.698 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : 0 instructors generated
    23:43:46.699 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : Removing 2 users from all courses...
    23:43:46.703 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : Removing 2 users from all courses. Done
    23:43:46.703 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : Save 2 users to database...
    23:43:46.716 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : Save 2 users to database. Done
    23:43:46.763 | 398 ool-1-worker-162 | DEBUG | PersonalAccessTokenManagementService : Generate secure vcs access token
    23:43:46.912 | 398 ool-1-worker-162 | INFO  | i.z.t.d.l.EmbeddedDatabaseReporter   : JDBC URL to connect to 'dataSource': url='jdbc:h2:tcp://localhost:41063/mem:f240edcd-27ce-47a3-b4ab-a6a00c154135;USER=sa', scope='IrisChatTokenTrackingIntegrationTest#testTokenTrackingSavedExerciseChat'

  Starting logs for IrisChatTokenTrackingIntegrationTest > testTokenTrackingExerciseChatWithPipelineFail()
    23:43:46.945 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : Generate 2 students...
    23:43:46.949 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : 2 students generated. Generate 0 tutors...
    23:43:46.951 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : 0 tutors generated. Generate 0 editors...
    23:43:46.952 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : 0 editors generated. Generate 0 instructors...
    23:43:46.953 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : 0 instructors generated
    23:43:46.955 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : Removing 2 users from all courses...
    23:43:46.955 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : Removing 2 users from all courses. Done
    23:43:46.955 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : Save 2 users to database...
    23:43:46.958 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.u.util.UserUtilService   : Save 2 users to database. Done
    23:43:46.990 | 398 ool-1-worker-162 | DEBUG | PersonalAccessTokenManagementService : Generate secure vcs access token
    23:43:47.159 | 398 ool-1-worker-162 | INFO  | i.z.t.d.l.EmbeddedDatabaseReporter   : JDBC URL to connect to 'dataSource': url='jdbc:h2:tcp://localhost:41063/mem:f240edcd-27ce-47a3-b4ab-a6a00c154135;USER=sa', scope='IrisChatTokenTrackingIntegrationTest#testTokenTrackingExerciseChatWithPipelineFail'
    23:43:47.165 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.s.f.ApiVersionFilter     : Adding Version to Request POST /api/iris/sessions/19/messages
    23:43:47.197 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.i.s.w.IrisWebsocketService : Sent message to Iris user irischattokentrackingintegrationstudent1 on topic /topic/iris/19: IrisChatWebsocketDTO[type=MESSAGE, message=IrisMessage{id=27, session=IrisExerciseChatSession{user=irischattokentrackingintegrationstudent1,exercise=ProgrammingExercise{id=436, templateRepositoryUri='null', solutionRepositoryUri='null', templateBuildPlanId='null', solutionBuildPlanId='null', allowOnlineEditor='true', allowOnlineIde='false', programmingLanguage='JAVA', packageName='de.test'', testCasesChanged='false'}}, sentAt=2025-02-14T23:43:47.188675Z, helpful=null, sender=USER, content=[IrisMessageContent{message=27, textContent='The happy dog jumped over the lazy dog.'}, IrisMessageContent{message=27, textContent='The happy dog jumped over the lazy dog.'}, IrisMessageContent{message=27, textContent='The happy dog jumped over the lazy dog.'}], messageDifferentiator=null}, rateLimitInfo=IrisRateLimitInformation[currentMessageCount=0, rateLimit=-1, rateLimitTimeframeHours=0], stages=null, suggestions=null, tokens=null]
    23:43:47.207 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.i.s.w.IrisWebsocketService : Sent message to Iris user irischattokentrackingintegrationstudent1 on topic /topic/iris/19: IrisChatWebsocketDTO[type=STATUS, message=null, rateLimitInfo=IrisRateLimitInformation[currentMessageCount=0, rateLimit=-1, rateLimitTimeframeHours=0], stages=[PyrisStageDTO[name=Preparing, weight=10, state=IN_PROGRESS, message=null], PyrisStageDTO[name=Executing pipeline, weight=30, state=NOT_STARTED, message=null]], suggestions=null, tokens=null]
    23:43:47.212 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.p.s.AbstractGitService     : getLastCommitHash http://localhost:49152/git/SHORTA79D99F50ECFE048520AD92019682A6003E9TSTEXC/shorta79d99f50ecfe048520ad92019682a6003e9tstexc-exercise.git
    23:43:47.212 | 398 ool-1-worker-162 | ERROR | d.t.c.a.a.p.s.AbstractGitService     : Cannot use ssh properly because of mismatch of Jgit transport object: org.eclipse.jgit.transport.TransportLocal@5d84ee8e
    23:43:47.222 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.p.s.AbstractGitService     : getLastCommitHash http://localhost:49152/git/SHORTA79D99F50ECFE048520AD92019682A6003E9TSTEXC/shorta79d99f50ecfe048520ad92019682a6003e9tstexc-solution.git
    23:43:47.222 | 398 ool-1-worker-162 | ERROR | d.t.c.a.a.p.s.AbstractGitService     : Cannot use ssh properly because of mismatch of Jgit transport object: org.eclipse.jgit.transport.TransportLocal@3c54e0b8
    23:43:47.228 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.p.service.GitService       : Cloning from file:///tmp/SHORTA79D99F50ECFE048520AD92019682A6003E9TSTEXC/shorta79d99f50ecfe048520ad92019682a6003e9tstexc-tests.git/ to repos/server-integration-test/SHORTA79D99F50ECFE048520AD92019682A6003E9TSTEXC/shorta79d99f50ecfe048520ad92019682a6003e9tstexc-tests
    23:43:47.240 | 398 ool-1-worker-162 | ERROR | d.t.c.a.a.p.s.AbstractGitService     : Cannot use ssh properly because of mismatch of Jgit transport object: org.eclipse.jgit.transport.TransportLocal@166437ba
    23:43:47.292 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.i.s.w.IrisWebsocketService : Sent message to Iris user irischattokentrackingintegrationstudent1 on topic /topic/iris/19: IrisChatWebsocketDTO[type=STATUS, message=null, rateLimitInfo=IrisRateLimitInformation[currentMessageCount=0, rateLimit=-1, rateLimitTimeframeHours=0], stages=[PyrisStageDTO[name=Preparing, weight=10, state=DONE, message=null], PyrisStageDTO[name=Executing pipeline, weight=30, state=IN_PROGRESS, message=null]], suggestions=null, tokens=null]
    23:43:47.295 | 398 ool-1-worker-162 | INFO  | d.t.c.a.a.c.s.jwt.TokenProvider      : Invalid JWT token: artemislocal_ase_in_tum_de-unknown-1739576627204-hqR7lbu36u from source bearer
    23:43:47.295 | 398 ool-1-worker-162 | INFO  | d.t.c.a.a.c.s.jwt.TokenProvider      : Invalid JWT token: artemislocal_ase_in_tum_de-unknown-1739576627204-hqR7lbu36u from source bearer
    23:43:47.295 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.c.s.f.ApiVersionFilter     : Adding Version to Request POST /api/public/pyris/pipelines/tutor-chat/runs/artemislocal_ase_in_tum_de-unknown-1739576627204-hqR7lbu36u/status
    23:43:47.317 | 398 ool-1-worker-162 | DEBUG | d.t.c.a.a.i.s.w.IrisWebsocketService : Sent message to Iris user irischattokentrackingintegrationstudent1 on topic /topic/iris/19: IrisChatWebsocketDTO[type=STATUS, message=null, rateLimitInfo=IrisRateLimitInformation[currentMessageCount=0, rateLimit=-1, rateLimitTimeframeHours=0], stages=[PyrisStageDTO[name=TestTokenFail, weight=10, state=ERROR, message=Failed running pipeline]], suggestions=null, tokens=[LLMRequest[model=test-llm, numInputTokens=5, costPerMillionInputToken=0.0, numOutputTokens=5, costPerMillionOutputToken=0.0, pipelineId=IRIS_CHAT_EXERCISE_MESSAGE], LLMRequest[model=test-llm, numInputTokens=15, costPerMillionInputToken=0.5, numOutputTokens=8, costPerMillionOutputToken=0.12, pipelineId=IRIS_CHAT_EXERCISE_MESSAGE], LLMRequest[model=test-llm, numInputTokens=25, costPerMillionInputToken=1.0, numOutputTokens=11, costPerMillionOutputToken=0.24, pipelineId=IRIS_CHAT_EXERCISE_MESSAGE], LLMRequest[model=test-llm, numInputTokens=35, costPerMillionInputToken=1.5, numOutputTokens=14, costPerMillionOutputToken=0.35999998, pipelineId=IRIS_CHAT_EXERCISE_MESSAGE], LLMRequest[model=test-llm, numInputTokens=45, costPerMillionInputToken=2.0, numOutputTokens=17, costPerMillionOutputToken=0.48, pipelineId=IRIS_CHAT_EXERCISE_MESSAGE]]]

Finished logs for IrisChatTokenTrackingIntegrationTest
]]></system-out>
  <system-err><![CDATA[]]></system-err>
</testsuite>
